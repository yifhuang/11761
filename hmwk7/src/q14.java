import java.io.IOException;

public class q14 {
	void solve() throws IOException {
		String trainData = Utils.filteInFile("hmm-test-korean.txt");
		int loops = 1000;
		double delta = 0.00001;
		int numS = 2;
		int numSy =27;
		int numT = trainData.length();
		Integer[] numOfFactorA = new Integer[1];
		Integer[] numOfFactorB = new Integer[1];
		double factor = 100000;
		double logll;
		Double[][] lamdas = new Double[numS][numS];
		Double[] intial = new Double[numS];
		Double[][] bs = new Double[numS][numSy];
		Double[] end = new Double[numS];
		Integer[] factorsB = new Integer[numT];
		Integer[] factorsA = new Integer[numT];
		//Utils.createMyParameters(trainData,lamdas, intial, bs, end);
		//Double[] a = {0.204658065515120000 ,0.015396036569681000 ,0.019105269501111800 ,0.063140901771885700 ,0.028077554920377000 ,0.000000000000000000 ,0.063257380571328000 ,0.051857157536814200 ,0.071143530513047500 ,0.038345415918167000 ,0.034921069318158000 ,0.010530187558858100 ,0.031644794339833400 ,0.076509472116574300 ,0.045604135149003800 ,0.004123225896178790 ,0.000000000000000000 ,0.010220937130243500 ,0.013354525048623900 ,0.052547801445143000 ,0.000130720566781841 ,0.000368823682035275 ,0.015193960082738300 ,0.000000000000000000 ,0.000059842121214300 ,0.000000000000000000 ,0.149809192727081000  };
		//Double[] b = {0.000179624955505600 ,0.013846897894921500 ,0.000000000000000800 ,0.001406019206570610 ,0.219923547462484000 ,0.000000000000000000 ,0.057094332992888100 ,0.000000002414549137 ,0.042361369461223900 ,0.008434552484544980 ,0.003340480254077260 ,0.039322451605512300 ,0.019021423598019000 ,0.106179921474460000 ,0.126532027348893000 ,0.015448544711088400 ,0.000000000000000000 ,0.043406832632022100 ,0.045478743349548900 ,0.002431111905592210 ,0.131266809227202000 ,0.000000003724642088 ,0.000001652648734279 ,0.000000000000000000 ,0.038616428684766300 ,0.000000000000000000 ,0.085707221962745000  };
		Double[] a={0.08492191337114867,0.01653657836569301,0.010594801879982843,0.0024586974400969503,0.13253613008631526,0.0,0.06810178759914401,0.028757315247152013,0.06409340977738814,0.026177567436536417,0.02120390473853379,0.028757307772000012,0.028632572759355025,0.1043035116838178,0.0830588442175527,0.011095543920479341,0.0,0.030949017909689288,0.03391030603528696,1.055939595394301E-6,0.07657681167481833,5.36908055081985E-34,0.006384469220837789,0.0,0.02253951366509329,0.0,0.11840893925947642};
		Double[] b={0.20875305210626982,5.204292967888986E-4,1.34578425932799E-12,0.2429668625855844,0.08160342353524652,0.0,0.0018424641739973016,3.0152043685368346E-8,3.5011132601757015E-4,1.9203994394832605E-5,7.892673485517575E-4,8.456969947312099E-8,1.4755560764517337E-5,6.0016752836351604E-5,0.11630191823897207,0.0014171573911015546,0.0,1.256225988789745E-4,9.03638993446069E-6,0.22244286090660484,2.105125824972365E-6,0.0014889594909099162,0.014867434086708278,0.0,5.0500863930080474E-8,0.0,0.10642515386665485};
		bs[0] = a;
		bs[1] = b;
		 	
		 	
		lamdas[0][0] =0.9346957427911446;
		lamdas[0][1] =0.06530425720885108  ;
		lamdas[1][0] =0.4755812791140837;
		lamdas[1][1] =0.52441872088591  ;
		intial[0] = 0.0;
		intial[1] = 1.0;
		end[0] = 1.0;
		end[1] =1.0;
		
		for(int t=0;t<1;t++){
			//Utils.createParameters(lamdas, intial, bs, end);
			//System.out.println(intial[0]);
			Double alphas[][] = Utils.alphaGen(factorsA,numOfFactorA, factor, trainData.toCharArray(), lamdas, bs, intial, end, numSy, numS, numT);
			Double betas[][] = Utils.betaGen(factorsB,numOfFactorB, factor, trainData.toCharArray(), lamdas, bs, intial, end, numSy, numS, numT);
			//System.out.println(numOfFactor[0]);
			logll=0;
			for(int i=0;i<numS;i++){
				logll+=alphas[i][numT-1];
			}
			double current = 1.0/numT*(Math.log(logll)-1.0*numOfFactorA[0]*Math.log(factor))/Math.log(2);;
			//System.out.println(Math.log(logll)-1.0*numOfFactorA[0]*Math.log(factor));
			System.out.println(current);
		}
		
	}
}
